{% extends 'global/base.html' %}

{% block page_title %}
    Dashboard Compras
{% endblock page_title %}

{% block content %}
<h5 class="mb-4 mt-3" style="color: green;">Dashboard Compras</h5>

<div class="container">
    <form action="" method="GET" class="d-flex align-items-center">
        <div class="mb-2 me-2">
            <label for="data_inicio" class="form-label">Data Início:</label>
            <input type="date" class="form-control" id="data_inicio" name="data_inicio" value="{{ data_inicio }}">
            <small class="form-text text-muted">Data da compra</small>
        </div>

        <div class="mb-2 ms-2 me-2">
            <label for="data_fim" class="form-label">Data Fim:</label>
            <input type="date" class="form-control" id="data_fim" name="data_fim" value="{{ data_fim }}">
            <small class="form-text text-muted">Data da compra</small>
        </div>

        <!-- Filtro para Período -->
        <div class="mb-2 ms-2 me-2">
            <label for="periodo" class="form-label">Fornecedor:</label>
            <select class="form-select" id="periodo" name="periodo">
                <option value="" {% if not request.GET.periodo %}selected{% endif %}>Todos os Fornecedores</option>
                <option value="Almoço" {% if request.GET.periodo == "Almoço" %}selected{% endif %}>Almoço</option>
                <option value="Jantar" {% if request.GET.periodo == "Jantar" %}selected{% endif %}>Jantar</option>
            </select>
        </div>
    </form>
</div>

<!-- cards -->
<!-- <div class="d-flex justify-content-around flex-wrap mt-2">
    <div class="card text-bg-light mb-3 mt-2" style="max-width: 18rem;">
        <div class="card-header">CMV</div>
            <div class="card-body">
                <h5 class="card-title tex-center">43</h5>
            </div>
    </div>
    <div class="card text-bg-light mb-3" style="max-width: 18rem;">
        <div class="card-header">Gasto Fixo</div>
        <div class="card-body">
            <h5 class="card-title text-center">{{ 89 }}</h5>
        </div>
    </div>
    <div class="card text-bg-info mb-3" style="max-width: 18rem;">
        <div class="card-header">Gasto Variável</div>
        <div class="card-body">
            <h5 class="card-title">R$ {{ 99 }}</h5>
        </div>
    </div>
</div> -->




<div class="card text-bg-primary mb-3" style="max-width: 12rem;">

    <div class="card-header">Total Compra</div>
        <div class="card-body">
                <h5 class="card-title">R$ {{ total_compras|floatformat:2 }}</h5>
                <p class="card-text">colocar as maiores porcentagens dos grupos.</p>
        </div>
    </div>
    
    <div class="card text-bg-primary mb-3" style="max-width: 12rem;">
        <div class="card-header">Total Pago</div>
        <div class="card-body">
            <h5 class="card-title">R$ {{ total_pago|floatformat:2 }}</h5>
            <p class="card-text">colocar as maiores porcentagens dos grupos.</p>
        </div>
    </div>
    
    <div class="card text-bg-primary mb-3" style="max-width: 12rem;">
        <div class="card-header">CMV</div>
            <div class="card-body">
                <h5 class="card-title">R$ {{ total_cmv|floatformat:2 }}</h5>
                <p class="card-text">colocar as maiores porcentagens dos grupos.</p>
            </div>
        </div>


    <div class="card text-bg-secondary mb-3" style="max-width: 12rem;">
        <div class="card-header">Gasto Variável</div>
            <div class="card-body">
                <h5 class="card-title">R$ {{ total_gasto_variavel|floatformat:2 }}</h5>
                <p class="card-text">colocar as maiores porcentagens dos grupos.</p>
            </div>
        </div>

    <div class="card text-bg-success mb-3" style="max-width: 12rem;">
        <div class="card-header">Gasto Fixo</div>
            <div class="card-body">
                <h5 class="card-title">R$ {{ total_gasto_fixo|floatformat:2 }}</h5>
                <p class="card-text">colocar as maiores porcentagens dos grupos.</p>
            </div>
        </div>
</div>


<div class="table-responsive">
    <table class="table table-sm mt-2">
        <thead class="table-light">
        <tr>
            <th scope="col">ID</th>
            <th scope="col">Data Compra</th>
            <th scope="col">Vencimento</th>
            <th scope="col">Pagamento</th>
            <th scope="col">Fornecedor</th>
            <th scope="col">Valor Compra</th>
            <th scope="col">Valor Pago</th>
            <th scope="col">N° Boleto</th>
            <th scope="col">Grupo</th>
            <th scope="col">Produto</th>
            <th scope="col">Classificação</th>
            <th scope="col">Forma Pagamento</th>
            <th scope="col">Ações</th>
        </tr>
        </thead>
        <tbody>
            {% for compras in compras_list %}
                <tr>
                    <th scope="row" >{{ compras.pk }}</th>
                    <td>{{ compras.data_compra| date:"d/m/y"}}</td>
                    <td>{{ compras.data_vencimento| date:"d/m/y"}}</td>
                    <td>{{ compras.data_pagamento| date:"d/m/y"}}</td>
                    <td>{{ compras.fornecedor }}</td>
                    <td>{{ compras.valor_compra| floatformat:2| default:"-" }}</td>
                    <td>{{ compras.valor_pago| floatformat:2| default:"-" }}</td>
                    <td>{{ compras.numero_boleto| default:"-" }}</td>
                    <td>{{ compras.grupo_produto| default:"-" }}</td>
                    <td>{{ compras.produto| default:"-" }}</td>
                    <td>{{ compras.classificacao| default:"-" }}</td>
                    <td>{{ compras.forma_pagamento| default:"-" }}</td>
                    <td>
                        <a href="{% url 'update_compras' pk=compras.pk %}" class="btn btn-secondary btn-sm" >Editar</a>
                        <a href="{% url 'delete_compras' pk=compras.pk %}" class="btn btn-danger btn-sm" >Excluir</a>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>


{% endblock content %}